name: PR Check Repository
on:
  pull_request:
    types: ["opened", "edited", "reopened", "synchronize"]
jobs:
  check_yaml:
    name: Validate Pull Request
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: Setup Node.js
        uses: actions/setup-node@v1
        with:
          node-version: "14.x"
      - run: npm install -g ./deployment/notebooktomdx
      - name: Setup Python 3
        uses: actions/setup-python@v2
        with:
          python-version: "3.8"
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r ./deployment/requirements.txt
      - name: Check
        run: python ./deployment/main.py
        env:
          S3_BUCKET_NAME: ${{ secrets.S3_BUCKET_NAME }}
          S3_BUCKET_NAME_RESOURCES: ${{ secrets.S3_BUCKET_NAME_RESOURCES }}
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          REGION_NAME: ${{ secrets.REGION_NAME }}
          MONGODB_URI: ${{ secrets.MONGODB_URI }}
          POSTGRES_DATABASE: ${{ secrets.POSTGRES_DATABASE }}
          POSTGRES_USER: ${{ secrets.POSTGRES_USER }}
          POSTGRES_PASSWORD: ${{ secrets.POSTGRES_PASSWORD }}
          POSTGRES_HOST: ${{ secrets.POSTGRES_HOST }}
